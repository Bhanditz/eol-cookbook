# common settings for all <%= @environment %> databases
common_<%= @environment %>: &common_<%= @environment %>
  adapter: mysql2
  encoding: utf8
  reconnect: true

master_common: &master_<%= @environment %>
  host: '<%= @master_host %>'
  <%- if @db_master_port %>
  port: <%=@db_master_port%>
  <%- end %>
  username: '<%= @master_user %>'
  password: '<%= @master_password %>'
  
  
############################################################
### <%= @environment.upcase%> DB ENVIRONMENT BUILT BY CHEF ###
############################################################

#master database connection for rails database
<%= @environment %>:
  <<: *common_<%= @environment %>
  <<: *master_<%= @environment %>
  database: <%= @db_prefix %><%= @db_environment %>

#<%= @environment %> database connection for logging database
<%= @environment %>_logging:
  <<: *common_<%= @environment %>
  <<: *master_<%= @environment %>
  database: <%= @db_logging_prefix %><%= @db_environment %>

#######################
##### MIGRATIONS ######
#######################

#migrations master database connection for rails database
<%= @environment %>_migrations:
  <<: *common_<%= @environment %>
  <<: *master_<%= @environment %>
  database: <%= @db_prefix %><%= @db_environment %>

#migrations master database connection for logging database
<%= @environment %>_migrations_logging:
  <<: *common_<%= @environment %>
  <<: *master_<%= @environment %>
  database: <%= @db_logging_prefix %><%= @db_environment %>
